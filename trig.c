

#include "trig.h"

#include <math.h>
#include <assert.h>

#define PRECISION	150

//static const FP sin_tab[] = { 0.0, 0.015150935439958792, 0.030298392770277051, 0.045438894679763073, 0.060568965453939527, 0.075685131772942407, 0.090783923508870365, 0.10586187452240114, 0.12091552345849253, 0.13594141454098485, 0.15093609836592292, 0.16589613269341502, 0.18081808323784737, 0.19569852445627239, 0.21053404033479045, 0.22532122517274333, 0.24005668436454086, 0.25473703517894003, 0.2693589075355986, 0.28391894477872409, 0.2984138044476411, 0.31284015904410034, 0.32719469679615221, 0.34147412241841074, 0.35567515786853215, 0.36979454309973586, 0.38382903680919367, 0.39777541718211645, 0.41163048263136659, 0.42539105253242754, 0.43905396795356066, 0.45261609238098227, 0.46607431243889419, 0.47942553860420301, 0.4926667059157635, 0.50579477467798317, 0.5188067311586273, 0.53169958828066299, 0.54447038630798505, 0.55711619352486463, 0.56963410690896565, 0.5820212527977745, 0.59427478754828944, 0.60639189818981865, 0.61836980306973699, 0.63020575249205379, 0.64189702934864368, 0.65344094974299705, 0.66483486360634592, 0.67607615530602472, 0.6871622442459252, 0.69809058545890867, 0.70885867019103832, 0.71946402647749952, 0.7299042197100738, 0.7401768531960371, 0.75027956870835422, 0.7602100470270432, 0.76996600847158458, 0.77954521342425387, 0.78894546284425737, 0.79816459877255286, 0.80720050482723937, 0.81605110668940195, 0.82471437257930114, 0.83318831372279623, 0.8414709848078965, 0.84956048443133436, 0.85745495553505957, 0.86515258583255294, 0.87265160822486176, 0.87995030120626239, 0.88704698925945624, 0.89394004324020782, 0.90062788075133782, 0.90710896650598483, 0.91338181268005125, 0.91944497925375512, 0.92529707434220609, 0.93093675451493263, 0.93636272510428475, 0.94157374050264375, 0.94656860444836854, 0.95134617030041413, 0.9559053413015598, 0.96024507083018429, 0.96436436264053293, 0.96826227109141971, 0.97193790136331271, 0.97539040966375212, 0.97861900342105446, 0.9816229414662595, 0.98440153420327448, 0.98695414376718205, 0.98928018417067021, 0.99137912143855411, 0.99325047373035769, 0.99489381145092659, 0.99630875734904811, 0.99749498660405445, 0.99845222690038948, 0.99918025849012326, 0.9996789142433975, 0.999948079686793, 1.0 };

static const FP sin_tab[] = { 0.0, 0.0066666172840603574, 0.013332938275116585, 0.01999866669333308, 0.02666350628521072, 0.033327160836753619, 0.039989334186634161, 0.046649730239355675, 0.053308052978412172, 0.059964006479444595, 0.066617294923392995, 0.073267622609643923, 0.079914693969172695, 0.086558213577679718, 0.09319788616872042, 0.099833416646828155, 0.10646451010062949, 0.11309087181595134, 0.11971220728891936, 0.12632822223904688, 0.13293862262231407, 0.13954311464423649, 0.14614140477292251, 0.15273319975211921, 0.15931820661424598, 0.16589613269341502, 0.17246668563843903, 0.17902957342582418, 0.18558450437274915, 0.19213118715002861, 0.19866933079506122, 0.20519864472476121, 0.21171883874847319, 0.21822962308086932, 0.22473070835482883, 0.23122180563429856, 0.23770262642713458, 0.24417288269792403, 0.25063228688078659, 0.25708055189215512, 0.26351739114353506, 0.26994251855424145, 0.27635564856411376, 0.28275649614620707, 0.28914477681946033, 0.29552020666133955, 0.30188250232045688, 0.30823138102916364, 0.31456656061611776, 0.32088775951882492, 0.32719469679615221, 0.3334870921408144, 0.33976466589183191, 0.3460271390469602, 0.35227423327508994, 0.35850567092861718, 0.36472117505578305, 0.37092046941298268, 0.37710327847704295, 0.38326932745746767, 0.38941834230865052, 0.3955500497420546, 0.40166417723835895, 0.40776045305957015, 0.41383860626109975, 0.41989836670380581, 0.42593946506599961, 0.43196163285541495, 0.43796460242114138, 0.44394810696551978, 0.44991188055599968, 0.45585565813695872, 0.4617791755414829, 0.46768216950310704, 0.47356437766751563, 0.47942553860420301, 0.48526539181809231, 0.49108367776111306, 0.49688013784373675, 0.50265451444646925, 0.50840655093130116, 0.51413599165311319, 0.5198425819710385, 0.52552606825978032, 0.5311861979208834, 0.53682271939396131, 0.54243538216787635, 0.54802393679187356, 0.55358813488666736, 0.55912772915548059, 0.56464247339503537, 0.57013212250649548, 0.57559643250635961, 0.58103516053730508, 0.58644806487898127, 0.59183490495875291, 0.59719544136239211, 0.60252943584471874, 0.60783665134018949, 0.6131168519734338, 0.61836980306973699, 0.62359527116547064, 0.62879302401846859, 0.63396283061834813, 0.63910446119677844, 0.64421768723769102, 0.64930228148743707, 0.65435801796488668, 0.6593846719714731, 0.66438202010117919, 0.66934984025046618, 0.67428791162814505, 0.67919601476518976, 0.68407393152449103, 0.68892144511055131, 0.69373834007912039, 0.69852440234677027, 0.70327941920041015, 0.7080031793067405, 0.71269547272164524, 0.71735609089952279, 0.72198482670255448, 0.72658147440991128, 0.73114582972689579, 0.73567768979402348, 0.7401768531960371, 0.7446431199708593, 0.74907629161847988, 0.7534761711097776, 0.75784256289527696, 0.76217527291383969, 0.76647410860128917, 0.7707388788989693, 0.77496939426223543, 0.77916546666887887, 0.78332690962748341, 0.78745353818571362, 0.79154516893853533, 0.79560162003636603, 0.7996227111931582, 0.80360826369441118, 0.80755810040511422, 0.81147204577761944, 0.81534992585944333, 0.81919156830099826, 0.82299680236325268, 0.82676545892531905, 0.83049737049197048, 0.83419237120108503, 0.83785029683101708, 0.8414709848078965, 0.84505427421285351, 0.84860000578917116, 0.85210802194936297, 0.85557816678217702, 0.85901028605952545, 0.86240422724333843, 0.86575983949234436, 0.86907697366877346, 0.87235548234498628, 0.87559521981002553, 0.87879604207609263, 0.88195780688494751, 0.88508037371422976, 0.88816360378370574, 0.89120736006143542, 0.89421150726986276, 0.89717591189182877, 0.90010044217650509, 0.90298496814524887, 0.90582936159738114, 0.90863349611588318, 0.91139724707301595, 0.91412049163585829, 0.91680310877176685, 0.91944497925375512, 0.92204598566579188, 0.92460601240802032, 0.92712494570189574, 0.92960267359524162, 0.93203908596722629, 0.93443407453325666, 0.93678753284979033, 0.9390993563190676, 0.94136944219375907, 0.94359768958153312, 0.94578399944953895, 0.94792827462880924, 0.95003041981857794, 0.95209034159051575, 0.95410794839288315, 0.9560831505545988, 0.95801586028922492, 0.95990599169886948, 0.96175346077800306, 0.96355818541719296, 0.96532008540675218, 0.96703908244030468, 0.96871510011826523, 0.97034806395123507, 0.97193790136331271, 0.97348454169531939, 0.97498791620793923, 0.97644795808477469, 0.97786460243531625, 0.97923778629782565, 0.9805674486421353, 0.98185353037235967, 0.98309597432952267, 0.98429472529409734, 0.98544972998846014, 0.98656093707925951, 0.98762829717969636, 0.98865176285171974, 0.9896312886081351, 0.99056683091462527, 0.99145834819168643, 0.99230580081647524, 0.99310915112456999, 0.99386836341164486, 0.9945834039350564, 0.99525424091534365, 0.99588084453764003, 0.99646318695299885, 0.99700124227963083, 0.99749498660405445, 0.99794439798215873, 0.99834945644017881, 0.998710143975583, 0.99902644455787371, 0.9992983441292993, 0.99952583060547906, 0.99970889387594042, 0.99984752580456826, 0.9999417202299663, 0.9999914729657311, 1.0 };

FP sint( FP angle )
{
	angle = fmodf(angle, 2*M_PI);
	if (angle < M_PI/2) /* first quadrant */
		return sin_tab[(int)(angle*PRECISION+0.5)];

	else if (angle < M_PI) /* second quadrant */
		return sin_tab[(int)((M_PI-angle)*PRECISION+0.5)];

	else if (angle < M_PI*3/2) /* third quadrant */
		return -sin_tab[(int)((angle-M_PI)*PRECISION+0.5)];

	else if (angle < 2*M_PI) /* fourth quadrant */
		return -sin_tab[(int)((2*M_PI-angle)*PRECISION+0.5)]; 

	else
		assert((int)angle);

	return 0;	
}


FP cost( FP angle )
{
	angle = fmodf(angle+M_PI/2, 2*M_PI);
	return sint( angle );
}
